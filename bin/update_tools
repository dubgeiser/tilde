#!/usr/bin/env bash


brew_update() {
    brew upgrade
    brew cask upgrade --greedy
}


brew_check_for_updates() {
    print_start_tool_update "HomeBrew"
    brew update
    echo
    echo cask
    echo '----'
    brew cask outdated --greedy
}


composer_update() {
    print_start_tool_update "Composer"
    composer global update
}


vim_update() {
    print_start_tool_update "Vim"
    cd "$HOME"/.vim/ || print_error_and_exit 'CANNOT CD TO VIM DIRECTORY'
    ./update
}


print_error_and_exit() {
    local message=$1
    echo
    echo "*** ERROR ***"
    printf "*** %s" "$message"
    echo
    exit 1
}


underline() {
    local tool=$1
    local char=$2
    if [[ "$char" == "" ]]; then
        char='='
    fi
    python -c "print('$char' * ${#tool})"
}


print_start_tool_update() {
    local tool=$1
    echo
    underline "$tool"
    echo "$tool"
    underline "$tool"
}


pushd "$(pwd)" || print_error_and_exit 'CANNOT PUSH WORKING DIR TO THE DIRSTACK'
composer_update
vim_update
brew_check_for_updates
popd || print_error_and_exit 'CANNOT POP FROM DIRSTACK'
